---
title: "Inhibitors and stimulators of hatching"
author: "Lieke Vlaar"
date: "07/09/2021"
output: html_document
---

Initiate the necessary libraries:

```{r, message = FALSE, warning = FALSE}
library(ggpmisc)
library(extrafont)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(plotrix)
```

Load the necessary functions:

```{r, message = FALSE, warning = FALSE}
source("scripts/hatch_calc.R")
source("scripts/hatch_summ.R")
```

Make a plot for figure A (solanoeclepin A inhibition in Gros)

```{r figA, fig.width = 3, fig.height = 5, message = FALSE, warning = FALSE}
h_c1 <- hatch_calc(input = "input/fig1_sola_rawdata.csv")
h_s1 <- hatch_summ(input = "input/fig1_sola_rawdata.csv")

h_c1$treatment <- factor(h_c1$treatment, levels = c("solA5",
                                                    "atrop2.5",
                                                    "Ly500",
                                                    "Akt50",
                                                    "ketoc100",
                                                    "dafa50"), ordered = TRUE)
h_c1 <- h_c1[order(h_c1$treatment),]
h_s1$treatment <- factor(h_s1$treatment, levels = c("solA5",
                                                    "atrop2.5",
                                                    "Ly500",
                                                    "Akt50",
                                                    "ketoc100",
                                                    "dafa50"), ordered = TRUE)
h_s1 <- h_s1[order(h_s1$treatment),]


p1 <- ggplot(data = h_s1, aes(x = treatment, y = mean_hatch)) +
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black",
           fill = "lightgrey") +
  geom_errorbar(aes(x = treatment,
                    y = mean_hatch,
                    ymin = mean_hatch - sterr,
                    ymax = mean_hatch + sterr),
                position = position_dodge(width = .9), width = 0.2) + 
  geom_jitter(data = h_c1,
              aes(x = treatment,
                  y = hatchingpercent),
              position = position_dodge(width = .9)) +
  theme_minimal() +
  theme(legend.text = element_text(size = 15),
        legend.text.align = 0,
        text = element_text(size = 15),
        axis.text.x = element_text(size = 8,
                                   angle = 45,
                                   hjust = 1)) +
  labs(y = "% hatch", x = "") +
  scale_y_continuous(limits = c(-5.5, 65), breaks = seq(0, 100, by = 10)) +
  scale_x_discrete(labels = c("solA 5 nM", 
                              "solA + atropine 2.5 mM",
                              "solA + LY294002 500\U03BCM",
                              "solA + Akt inhibitor IV 50 \U03BCM",
                              "solA + ketoconazole 100 \U03BCM",
                              "solA + dafadine 50 \U03BCM"))
p1
```

Make a plot for figure B

```{r figB, fig.width = 3, fig.height = 5, message = FALSE, warning = FALSE}
h_c2 <- hatch_calc(input = "input/fig2A_TRDlsolA_rawdata.csv")
h_s2 <- hatch_summ(input = "input/fig2A_TRDlsolA_rawdata.csv")

h_c2$treatment <- factor(h_c2$treatment, levels = c("TRD_lsolA",
                                                    "atrop2.5",
                                                    "Ly500",
                                                    "Akt50",
                                                    "ketoc100",
                                                    "dafa50"), ordered = TRUE)
h_c2 <- h_c2[order(h_c2$treatment),]
h_s2$treatment <- factor(h_s2$treatment, levels = c("TRD_lsolA",
                                                    "atrop2.5",
                                                    "Ly500",
                                                    "Akt50",
                                                    "ketoc100",
                                                    "dafa50"), ordered = TRUE)
h_s2 <- h_s2[order(h_s2$treatment),]


p2 <- ggplot(data = h_s2, aes(x = treatment, y = mean_hatch)) +
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black",
           fill = "lightgrey") +
  geom_errorbar(aes(x = treatment,
                    y = mean_hatch,
                    ymin = mean_hatch - sterr,
                    ymax = mean_hatch + sterr),
                position = position_dodge(width = .9), width = 0.2) + 
  geom_jitter(data = h_c2,
              aes(x = treatment,
                  y = hatchingpercent),
              position = position_dodge(width = .9)) +
  theme_minimal() +
  theme(legend.text = element_text(size = 15),
        legend.text.align = 0,
        text = element_text(size = 15),
        axis.text.x = element_text(size = 8,
                                   angle = 45,
                                   hjust = 1)) +
  labs(y = "% hatch", x = "") +
  scale_y_continuous(limits = c(-5.5, 85), breaks = seq(0, 100, by = 10)) + 
  scale_x_discrete(labels = c("TRE low solA", 
                              "TRE + atropine 2.5 mM",
                              "TRE + LY294002 500\U03BCM",
                              "TRE + Akt inhibitor IV 50 \U03BCM",
                              "TRE + ketoconazole 100 \U03BCM",
                              "TRE + dafadine 50 \U03BCM"))
p2

```
And figure c

```{r figC, fig.width = 3, fig.height = 5, message = FALSE, warning = FALSE}

h_c3 <- hatch_calc(input = "input/fig2B_TRDhsolA_rawdata.csv")
h_s3 <- hatch_summ(input = "input/fig2B_TRDhsolA_rawdata.csv")

h_c3$treatment <- factor(h_c3$treatment, levels = c("TRD_hsolA",
                                                    "atrop2.5",
                                                    "Ly500",
                                                    "Akt50",
                                                    "ketoc100",
                                                    "dafa50"), ordered = TRUE)
h_c3 <- h_c3[order(h_c3$treatment),]
h_s3$treatment <- factor(h_s3$treatment, levels = c("TRD_hsolA",
                                                    "atrop2.5",
                                                    "Ly500",
                                                    "Akt50",
                                                    "ketoc100",
                                                    "dafa50"), ordered = TRUE)
h_s3 <- h_s3[order(h_s3$treatment),]


p3 <- ggplot(data = h_s3, aes(x = treatment, y = mean_hatch)) +
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black",
           fill = "lightgrey") +
  geom_errorbar(aes(x = treatment,
                    y = mean_hatch,
                    ymin = mean_hatch - sterr,
                    ymax = mean_hatch + sterr),
                position = position_dodge(width = .9), width = 0.2) + 
  geom_jitter(data = h_c3,
              aes(x = treatment,
                  y = hatchingpercent),
              position = position_dodge(width = .9)) +
  theme_minimal() +
  theme(legend.text = element_text(size = 15),
        legend.text.align = 0,
        text = element_text(size = 15),
        axis.text.x = element_text(size = 8,
                                   angle = 45,
                                   hjust = 1)) +
  labs(y = "% hatch", x = "") +
  scale_y_continuous(limits = c(-5.5, 95), breaks = seq(0, 100, by = 10)) + 
  scale_x_discrete(labels = c("TRE high solA", 
                              "TRE + atropine 2.5 mM",
                              "TRE + LY294002 500\U03BCM",
                              "TRE + Akt inhibitor IV 50 \U03BCM",
                              "TRE + ketoconazole 100 \U03BCM",
                              "TRE + dafadine 50 \U03BCM"))
p3
```


Figure D:

```{r figD, fig.width = 3, fig.height = 5, message = FALSE, warning = FALSE}

h_c4 <- hatch_calc(input = "input/fig3_rawdata.csv")
h_s4 <- hatch_summ(input = "input/fig3_rawdata.csv")

h_c4$treatment <- factor(h_c4$treatment, levels = c("8cG_1mM",
                                                    "8brc1_atrop2.5",
                                                    "8cG_1mM_LY500uM",
                                                    "8cG_1mM_ktc500uM",
                                                    "8cG_1mM_dfd50uM"), ordered = TRUE)
h_c4 <- h_c4[order(h_c4$treatment),]
h_s4$treatment <- factor(h_s4$treatment, levels = c("8cG_1mM",
                                                    "8brc1_atrop2.5",
                                                    "8cG_1mM_LY500uM",
                                                    "8cG_1mM_ktc500uM",
                                                    "8cG_1mM_dfd50uM"), ordered = TRUE)
h_s4 <- h_s4[order(h_s4$treatment),]


p4 <- ggplot(data = h_s4, aes(x = treatment, y = mean_hatch)) +
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black",
           fill = "lightgrey") +
  geom_errorbar(aes(x = treatment,
                    y = mean_hatch,
                    ymin = mean_hatch - sterr,
                    ymax = mean_hatch + sterr),
                position = position_dodge(width = .9), width = 0.2) + 
  geom_jitter(data = h_c4,
              aes(x = treatment,
                  y = hatchingpercent),
              position = position_dodge(width = .9)) +
  theme_minimal() +
  theme(legend.text = element_text(size = 15),
        legend.text.align = 0,
        text = element_text(size = 15),
        axis.text.x = element_text(size = 8,
                                   angle = 45,
                                   hjust = 1)) +
  labs(y = "% hatch", x = "") +
  scale_y_continuous(limits = c(-5.5, 65), breaks = seq(0, 100, by = 10)) +
  scale_x_discrete(labels = c("8-Br-cGMP 1mM", 
                              "8-Br-cGMP + atropine 2.5 mM",
                              "8-Br-cGMP + LY294002 500\U03BCM",
                              "8-Br-cGMP + ketoconazole 500 \U03BCM",
                              "8-Br-cGMP + dafadine 50 \U03BCM"))
p4
```

Assmble plots:

```{r assemble, fig.width = 7, fig.height = 9}
library(patchwork)

p4 + p1 + p2 + p3 +  
  plot_annotation(tag_levels = 'A') & 
  theme(plot.tag = element_text(size = 15))
```

Inhibition of hatching of G. pallida

```{r figE, fig.width = 3, fig.height = 5, message = FALSE, warning = FALSE}

h_c5 <- hatch_calc(input = "input/210511_inhstim_Gpa.csv")
h_s5 <- hatch_summ(input = "input/210511_inhstim_Gpa.csv")

h_c5$treatment <- factor(h_c5$treatment, levels = c("solA500pM",
                                                    "solA500pM_20uMdafa",
                                                    "solA500pM_50uMdafa",
                                                    "solA500pM_100uMdafa",
                                                    "twater"), ordered = TRUE)
h_c5 <- h_c5[order(h_c5$treatment),]
h_s5$treatment <- factor(h_s5$treatment, levels = c("solA500pM",
                                                    "solA500pM_20uMdafa",
                                                    "solA500pM_50uMdafa",
                                                    "solA500pM_100uMdafa",
                                                    "twater"), ordered = TRUE)
h_s5 <- h_s5[order(h_s5$treatment),]


p5 <- ggplot(data = h_s5, aes(x = treatment, y = mean_hatch)) +
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black",
           fill = "lightgrey") +
  geom_errorbar(aes(x = treatment,
                    y = mean_hatch,
                    ymin = mean_hatch - sterr,
                    ymax = mean_hatch + sterr),
                position = position_dodge(width = .9), width = 0.2) + 
  geom_jitter(data = h_c5,
              aes(x = treatment,
                  y = hatchingpercent),
              position = position_dodge(width = .9)) +
  theme_minimal() +
  theme(legend.text = element_text(size = 15),
        legend.text.align = 0,
        text = element_text(size = 15),
        axis.text.x = element_text(size = 8,
                                   angle = 45,
                                   hjust = 1)) +
  labs(y = "% hatch", x = "") +
  scale_y_continuous(limits = c(-0, 60), breaks = seq(0, 100, by = 10)) +
  scale_x_discrete(labels = c("solA 0.5nm", 
                              "solA + dafadine 100\U03BCM",
                              "solA + dafadine 50\U03BCM",
                              "solA + dafadine 20\U03BCM",
                              "tap water"))
p5
```

## Atropine

All other, supplementary, plots, showing what was tried

atropine, first get overview of everything sorted by date:

```{r atrop1, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
atrop_c <- hatch_calc(input = "input/combined_per_treatment_atropine.csv")
atrop_s <- hatch_summ1(input = "input/combined_per_treatment_atropine.csv")

overview <- function(atrop_c, atrop_s, xf = 50){
  x <- ggplot(data = atrop_s, aes(x = treatment, y = mean_hatch)) +
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black",
           fill = "lightgrey") +
  geom_errorbar(aes(x = treatment,
                    y = mean_hatch,
                    ymin = mean_hatch - sterr,
                    ymax = mean_hatch + sterr),
                position = position_dodge(width = .9), width = 0.2) + 
  geom_jitter(data = atrop_c,
              aes(x = treatment,
                  y = hatchingpercent),
              position = position_dodge(width = .9)) +
  geom_point(data = atrop_s, aes(x = treatment, y = concentration.uM./xf), color = "red") +
  theme_minimal() +
  theme(legend.text = element_text(size = 15),
        legend.text.align = 0,
        text = element_text(size = 15),
        axis.text.x = element_text(size = 8,
                                   angle = 45,
                                   hjust = 1)) +
  labs(y = "% hatch", x = "") +
  scale_y_continuous(limits = c(-10, 100), breaks = seq(0, 100, by = 10),
                     sec.axis = sec_axis(trans=~.*50, name="atropine conc")) +
  facet_grid(~date, scales = "free", space = "free")
  return(x)}
p_atrop <- overview(atrop_c, atrop_s)

p_atrop

#make overview separately for solA, TRDh, TRDl

atrop_c_solA <- atrop_c[grep("TRD|PRE|8c|PRD|8b", atrop_c$treatment, ignore.case = T, invert = T),]
atrop_s_solA <- atrop_s[grep("TRD|PRE|8c|PRD|8b", atrop_s$treatment, ignore.case = T, invert = T),]

p_atrop2 <- overview(atrop_c_solA, atrop_s_solA)
p_atrop2

atrop_c_TRDl <- atrop_c[grep("TRD_l", atrop_c$treatment, ignore.case = T),]
atrop_s_TRDl <- atrop_s[grep("TRD_l", atrop_s$treatment, ignore.case = T),]

p_atrop3 <- overview(atrop_c_TRDl, atrop_s_TRDl)
p_atrop3

atrop_c_TRDh <- atrop_c[grep("TRD_h", atrop_c$treatment, ignore.case = T),]
atrop_s_TRDh <- atrop_s[grep("TRD_h", atrop_s$treatment, ignore.case = T),]

p_atrop3 <- overview(atrop_c_TRDh, atrop_s_TRDh)
p_atrop3
```

Then filter on what to show and make supplemental figure plot:

```{r atrop2, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
#supplemental figure atrop_solA
atrop_c_solA <- hatch_calc(input = "input/atrop_solA.csv")
atrop_c_solA$treatment <- factor(atrop_c_solA$treatment, levels = c("solA20",
                                                          "solA5",
                                                          "solA20_atrop1",
                                                          "solA5_atrop2.5",
                                                          "solA5_atrop5"), ordered = TRUE)
atrop_c_solA <- atrop_c_solA[order(atrop_c_solA$treatment), ]
atrop_s_solA <- hatch_summ(input = "input/atrop_solA.csv")
atrop_s_solA$treatment <- factor(atrop_s_solA$treatment, levels = c("solA20",
                                                          "solA5",
                                                          "solA20_atrop1",
                                                          "solA5_atrop2.5",
                                                          "solA5_atrop5"), ordered = TRUE)
atrop_s_solA <- atrop_s_solA[order(atrop_s_solA$treatment),]

range <- function(atrop_c, atrop_s){
  x <- ggplot(data = atrop_s, aes(x = treatment, y = mean_hatch)) +
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black",
           fill = "lightgrey") +
  geom_errorbar(aes(x = treatment,
                    y = mean_hatch,
                    ymin = mean_hatch - sterr,
                    ymax = mean_hatch + sterr),
                position = position_dodge(width = .9), width = 0.2) + 
  geom_jitter(data = atrop_c,
              aes(x = treatment,
                  y = hatchingpercent),
              position = position_dodge(width = .9)) +
  theme_minimal() +
  theme(legend.text = element_text(size = 15),
        legend.text.align = 0,
        text = element_text(size = 15),
        axis.text.x = element_text(size = 8,
                                   angle = 45,
                                   hjust = 1)) +
  labs(y = "% hatch", x = "") +
  scale_y_continuous(limits = c(-10, 95), breaks = seq(0, 100, by = 10))
  return(x)}
sf_atrop1 <- range(atrop_c_solA, atrop_s_solA)
sf_atrop1

#for TRDl samples
atrop_c_TRDl <- hatch_calc(input = "input/atrop_TRD_lsolA.csv")
atrop_c_TRDl$treatment <- factor(atrop_c_TRDl$treatment, levels = c("TRD_lsolA",
                                                                    "atrop1000",
                                                                    "atrop2500",
                                                                    "atrop5000"),
                                 ordered = TRUE)
atrop_c_TRDl <- atrop_c_TRDl[order(atrop_c_TRDl$treatment),]
atrop_s_TRDl <- hatch_summ(input = "input/atrop_TRD_lsolA.csv")
atrop_s_TRDl$treatment <- factor(atrop_s_TRDl$treatment, levels = c("TRD_lsolA",
                                                                    "atrop1000",
                                                                    "atrop2500",
                                                                    "atrop5000"),
                                 ordered = TRUE)
atrop_s_TRDl <- atrop_s_TRDl[order(atrop_s_TRDl$treatment),]

sf_atrop2 <- range(atrop_c_TRDl, atrop_s_TRDl)
sf_atrop2

#for TRDh samples
atrop_c_TRDh <- hatch_calc(input = "input/atrop_TRD_hsolA.csv")
atrop_c_TRDh$treatment <- factor(atrop_c_TRDh$treatment, levels = c("TRD_hsolA",
                                                                    "atrop_1000_TRD_hsolA",
                                                                    "atrop_2500_TRD_hsolA",
                                                                    "atrop_TRD_hsolA"),
                                 ordered = TRUE)
atrop_c_TRDh <- atrop_c_TRDh[order(atrop_c_TRDh$treatment),]
atrop_s_TRDh <- hatch_summ(input = "input/atrop_TRD_hsolA.csv")
atrop_s_TRDh$treatment <- factor(atrop_s_TRDh$treatment, levels = c("TRD_hsolA",
                                                                    "atrop_1000_TRD_hsolA",
                                                                    "atrop_2500_TRD_hsolA",
                                                                    "atrop_TRD_hsolA"),
                                 ordered = TRUE)
atrop_s_TRDh <- atrop_s_TRDh[order(atrop_s_TRDh$treatment),]

sf_atrop3 <- range(atrop_c_TRDh, atrop_s_TRDh)
sf_atrop3

#Arrange and change names x axis

sf_atrop1 <- sf_atrop1 + scale_x_discrete(labels = c("20nM solA",
                                                     "5nM solA",
                                                     "20nM solA + 1mM atropine",
                                                     "5nM solA + 2.5mM atropine",
                                                     "5nM solA + 5mM atropine"))
sf_atrop2 <- sf_atrop2 + scale_x_discrete(labels = c("TRD_lsolA + 0mM atropine",
                                                     "TRD_lsolA + 1mM atropine",
                                                     "TRD_lsolA + 2.5mM atropine",
                                                     "TRD_lsolA + 5mM atropine"))
sf_atrop3 <- sf_atrop3 + scale_x_discrete(labels = c("TRD_hsolA + 0mM atropine",
                                                     "TRD_hsolA + 1mM atropine",
                                                     "TRD_hsolA + 2.5mM atropine",
                                                     "TRD_hsolA + 5mM atropine"))

SF1 <- sf_atrop1 + sf_atrop2 + sf_atrop3
```

## Akt inhibitor IV

```{r akt1, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
akt_c <- hatch_calc(input = "input/combined_per_treatment_AktinhibitorIV.csv")
akt_s <- hatch_summ1(input = "input/combined_per_treatment_AktinhibitorIV.csv")
p_akt <- overview(akt_c, akt_s, xf = 1)
p_akt

#make separate overviews for solA, TRD_l and TRD_h

akt_c_solA <- akt_c[grep("TRD|PRE|8c|PRD|8b", akt_c$treatment, ignore.case = T, invert = T),]
akt_s_solA <- akt_s[grep("TRD|PRE|8c|PRD|8b", akt_s$treatment, ignore.case = T, invert = T),]

p_akt2 <- overview(akt_c_solA, akt_s_solA, xf = 1)
p_akt2

akt_c_TRDl <- akt_c[grep("TRD_l", akt_c$treatment, ignore.case = T),]
akt_s_TRDl <- akt_s[grep("TRD_l", akt_s$treatment, ignore.case = T),]

p_akt3 <- overview(akt_c_TRDl, akt_s_TRDl, xf = 1)
p_akt3

akt_c_TRDh <- akt_c[grep("TRD_h", akt_c$treatment, ignore.case = T),]
akt_s_TRDh <- akt_s[grep("TRD_h", akt_s$treatment, ignore.case = T),]

p_akt4 <- overview(akt_c_TRDh, akt_s_TRDh, xf = 1)
p_akt4

```

```{r akt2, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
#supplemental figure Akt_solA

akt_c_solA <- hatch_calc(input = "input/Akt_solA.csv")
akt_s_solA <- hatch_summ(input = "input/Akt_solA.csv")
sf_akt1 <- range(akt_c_solA, akt_s_solA)
akt_c_solA$treatment <- factor(akt_c_solA$treatment, levels = c("solA5",
                                                                "Akt10_solA5",
                                                                "solA5_Akt25",
                                                                "Akt50_solA5",
                                                                "Akt100_solA5"), ordered = TRUE)
akt_c_solA <- akt_c_solA[order(akt_c_solA$treatment),]
akt_s_solA$treatment <- factor(akt_s_solA$treatment, levels = c("solA5",
                                                                "Akt10_solA5",
                                                                "solA5_Akt25",
                                                                "Akt50_solA5",
                                                                "Akt100_solA5"), ordered = TRUE)
akt_s_solA <- akt_s_solA[order(akt_s_solA$treatment),]
sf_akt1 <- range(akt_c_solA, akt_s_solA)
sf_akt1

#for TRDl samples
akt_c_TRDl <- hatch_calc(input = "input/Akt_TRDl.csv")
akt_s_TRDl <- hatch_summ(input = "input/Akt_TRDl.csv")
akt_c_TRDl$treatment <- factor(akt_c_TRDl$treatment, levels = c("TRD_lsolA",
                                                                "Akt10",
                                                                "Akt25",
                                                                "Akt50"), ordered = TRUE)
akt_c_TRDl <- akt_c_TRDl[order(akt_c_TRDl$treatment),]
akt_s_TRDl$treatment <- factor(akt_s_TRDl$treatment, levels = c("TRD_lsolA",
                                                                "Akt10",
                                                                "Akt25",
                                                                "Akt50"), ordered = TRUE)
akt_s_TRDl <- akt_s_TRDl[order(akt_s_TRDl$treatment),]
sf_akt2 <- range(akt_c_TRDl, akt_s_TRDl)
sf_akt2
#for TRDh samples
akt_c_TRDh <- hatch_calc(input = "input/Akt_TRDh.csv")
akt_s_TRDh <- hatch_summ(input = "input/Akt_TRDh.csv")
akt_c_TRDh$treatment <- factor(akt_c_TRDh$treatment, levels = c("TRD_hsolA",
                                                                "Akt10",
                                                                "Akt25",
                                                                "Akt50"), ordered = TRUE)
akt_c_TRDh <- akt_c_TRDh[order(akt_c_TRDh$treatment),]
akt_s_TRDh$treatment <- factor(akt_s_TRDh$treatment, levels = c("TRD_hsolA",
                                                                "Akt10",
                                                                "Akt25",
                                                                "Akt50"), ordered = TRUE)
akt_s_TRDh <- akt_s_TRDh[order(akt_s_TRDh$treatment),]
sf_akt3 <- range(akt_c_TRDh, akt_s_TRDh)
sf_akt3


#Arrange and change names x axis

sf_akt1 <- sf_akt1 + scale_x_discrete(labels = c("5nM solA",
                                                 "5nM solA + 10\U03BCM Akt inh. IV",
                                                 "5nM solA + 25\U03BCM Akt inh. IV",
                                                 "5nM solA + 50\U03BCM Akt inh. IV",
                                                 "5nM solA + 100\U03BCM Akt inh. IV"))
sf_akt2 <- sf_akt2 + scale_x_discrete(labels = c("TRD_lsolA + 0\U03BCM Akt inh. IV",
                                                 "TRD_lsolA + 10\U03BCM Akt inh. IV",
                                                 "TRD_lsolA + 25\U03BCM Akt inh. IV",
                                                 "TRD_lsolA + 50\U03BCM Akt inh. IV"))
sf_akt3 <- sf_akt3 + scale_x_discrete(labels = c("TRD_hsolA + 0\U03BCM Akt inh. IV",
                                                 "TRD_hsolA + 10\U03BCM Akt inh. IV",
                                                 "TRD_hsolA + 25\U03BCM Akt inh. IV",
                                                 "TRD_hsolA + 50\U03BCM Akt inh. IV"))

SF2 <- sf_akt1 + sf_akt2 + sf_akt3
```

## LY294002

```{r ly1, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
ly_c <- hatch_calc(input = "input/combined_per_treatment_LY294002.csv")
ly_s <- hatch_summ1(input = "input/combined_per_treatment_LY294002.csv")
p_ly <- overview(ly_c, ly_s, xf = 1)
p_ly

#make separate overviews for solA, TRD_l and TRD_h

ly_c_solA <- ly_c[grep("TRD|PRE|8c|PRD|8b", ly_c$treatment, ignore.case = T, invert = T),]
ly_s_solA <- ly_s[grep("TRD|PRE|8c|PRD|8b", ly_s$treatment, ignore.case = T, invert = T),]

p_ly2 <- overview(ly_c_solA, ly_s_solA, xf = 1)
p_ly2

ly_c_TRDl <- ly_c[grep("TRD_l", ly_c$treatment, ignore.case = T),]
ly_s_TRDl <- ly_s[grep("TRD_l", ly_s$treatment, ignore.case = T),]

p_ly3 <- overview(ly_c_TRDl, ly_s_TRDl, xf = 1)
p_ly3

ly_c_TRDh <- ly_c[grep("TRD_h", ly_c$treatment, ignore.case = T),]
ly_s_TRDh <- ly_s[grep("TRD_h", ly_s$treatment, ignore.case = T),]

p_ly4 <- overview(ly_c_TRDh, ly_s_TRDh, xf = 1)
p_ly4
#since only undiluted RE are relevant, no ranges for TRD for LY
```


```{r ly2, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
#supplemental figure ly_solA

ly_c_solA <- hatch_calc(input = "input/LY_solA.csv")
ly_s_solA <- hatch_summ(input = "input/LY_solA.csv")
sf_ly1 <- range(ly_c_solA, ly_s_solA)
ly_c_solA$treatment <- factor(ly_c_solA$treatment, levels = c("solA50",
                                                              "LY25_solA50",
                                                              "LY100_solA50",
                                                              "LY500_solA50",
                                                              "solA5",
                                                              "LY50_solA5",
                                                              "LY500_solA5"), ordered = TRUE)
ly_c_solA <- ly_c_solA[order(ly_c_solA$treatment),]
ly_s_solA$treatment <- factor(ly_s_solA$treatment, levels = c("solA50",
                                                              "LY25_solA50",
                                                              "LY100_solA50",
                                                              "LY500_solA50",
                                                              "solA5",
                                                              "LY50_solA5",
                                                              "LY500_solA5"), ordered = TRUE)
ly_s_solA <- ly_s_solA[order(ly_s_solA$treatment),]
sf_ly1 <- range(ly_c_solA, ly_s_solA)
sf_ly1


#Arrange and change names x axis

sf_ly1 <- sf_ly1 + scale_x_discrete(labels = c("50nM solA",
                                               "50nM solA + 25\U03BCM LY294,002",
                                               "50nM solA + 100\U03BCM LY294,002",
                                               "50nM solA + 500\U03BCM LY294,002",
                                               "5nM solA",
                                               "5nM solA + 50\U03BCM LY294,002",
                                               "5nM solA + 500\U03BCM LY294,002"))


SF3 <- sf_ly1
```

## Ketoconazole

```{r ket1, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
ke_c <- hatch_calc(input = "input/combined_per_treatment_ketoconazole.csv")
ke_s <- hatch_summ1(input = "input/combined_per_treatment_ketoconazole.csv")
p_ke <- overview(ke_c, ke_s, xf = 5)
p_ke

#make separate overviews for solA, TRD_l and TRD_h

ke_c_solA <- ke_c[grep("TRD|PRE|8c|PRD|8b", ke_c$treatment, ignore.case = T, invert = T),]
ke_s_solA <- ke_s[grep("TRD|PRE|8c|PRD|8b", ke_s$treatment, ignore.case = T, invert = T),]

p_ke2 <- overview(ke_c_solA, ke_s_solA, xf = 5)
p_ke2

ke_c_TRDl <- ke_c[grep("TRD_l", ke_c$treatment, ignore.case = T),]
ke_s_TRDl <- ke_s[grep("TRD_l", ke_s$treatment, ignore.case = T),]

p_ke3 <- overview(ke_c_TRDl, ke_s_TRDl, xf = 5)
p_ke3

ke_c_TRDh <- ke_c[grep("TRD_h", ke_c$treatment, ignore.case = T),]
ke_s_TRDh <- ke_s[grep("TRD_h", ke_s$treatment, ignore.case = T),]

p_ke4 <- overview(ke_c_TRDh, ke_s_TRDh, xf = 5)
p_ke4

```

```{r ket2, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
#supplemental figure ke_solA

ke_c_solA <- hatch_calc(input = "input/ke_solA.csv")
ke_s_solA <- hatch_summ(input = "input/ke_solA.csv")
sf_ke1 <- range(ke_c_solA, ke_s_solA)
ke_c_solA$treatment <- factor(ke_c_solA$treatment, levels = c("solA20nM",
                                                              "ketocon500_solA20",
                                                              "solA5",
                                                              "ketoc100_solA5",
                                                              "ketoc200_solA5"), ordered = TRUE)
ke_c_solA <- ke_c_solA[order(ke_c_solA$treatment),]
ke_s_solA$treatment <- factor(ke_s_solA$treatment, levels = c("solA20nM",
                                                              "ketocon500_solA20",
                                                              "solA5",
                                                              "ketoc100_solA5",
                                                              "ketoc200_solA5"), ordered = TRUE)
ke_s_solA <- ke_s_solA[order(ke_s_solA$treatment),]
sf_ke1 <- range(ke_c_solA, ke_s_solA)
sf_ke1

ke_c_TRDl <- hatch_calc(input = "input/ke_TRDl.csv")
ke_s_TRDl <- hatch_summ(input = "input/ke_TRDl.csv")
sf_ke2 <- range(ke_c_TRDl, ke_s_TRDl)
ke_c_TRDl$treatment <- factor(ke_c_TRDl$treatment, levels = c("TRD_lsolA",
                                                              "keto100_TRD_lsolA",
                                                              "keto200_TRD_lsolA"), ordered = TRUE)
ke_c_TRDl <- ke_c_TRDl[order(ke_c_TRDl$treatment),]
ke_s_TRDl$treatment <- factor(ke_s_TRDl$treatment, levels = c("TRD_lsolA",
                                                              "keto100_TRD_lsolA",
                                                              "keto200_TRD_lsolA"), ordered = TRUE)
ke_s_TRDl <- ke_s_TRDl[order(ke_s_TRDl$treatment),]
sf_ke2 <- range(ke_c_TRDl, ke_s_TRDl)
sf_ke2

ke_c_TRDh <- hatch_calc(input = "input/ke_TRDh.csv")
ke_s_TRDh <- hatch_summ(input = "input/ke_TRDh.csv")
sf_ke3 <- range(ke_c_TRDh, ke_s_TRDh)
ke_c_TRDh$treatment <- factor(ke_c_TRDh$treatment, levels = c("TRD_hsolA",
                                                              "keto100_TRD_hsolA",
                                                              "keto200_TRD_hsolA"), ordered = TRUE)
ke_c_TRDh <- ke_c_TRDh[order(ke_c_TRDh$treatment),]
ke_s_TRDh$treatment <- factor(ke_s_TRDh$treatment, levels = c("TRD_hsolA",
                                                              "keto100_TRD_hsolA",
                                                              "keto200_TRD_hsolA"), ordered = TRUE)
ke_s_TRDh <- ke_s_TRDh[order(ke_s_TRDh$treatment),]
sf_ke3 <- range(ke_c_TRDh, ke_s_TRDh)
sf_ke3


#Arrange and change names x axis

sf_ke1 <- sf_ke1 + scale_x_discrete(labels = c("20nM solA",
                                               "20nM solA + 500\U03BCM ketoconazole",
                                               "5nM solA",
                                               "5nM solA + 100\U03BCM ketoconazole",
                                               "5nM solA + 200\U03BCM ketoconazole"))
sf_ke2 <- sf_ke2 + scale_x_discrete(labels = c("TRD_lsolA + 0\U03BCM ketoconazole",
                                               "TRD_lsolA + 100\U03BCM ketoconazole",
                                               "TRD_lsolA + 200\U03BCM ketoconazole"))
sf_ke3 <- sf_ke3 + scale_x_discrete(labels = c("TRD_hsolA + 0\U03BCM ketoconazole",
                                               "TRD_hsolA + 100\U03BCM ketoconazole",
                                               "TRD_hsolA + 200\U03BCM ketoconazole"))

layout <- "AABCD"
SF4 <- sf_ke1 + sf_ke2 + sf_ke3 + plot_spacer() + plot_layout(design = layout)
SF4
```


## Dafadine

```{r dafa1, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
dafa_c <- hatch_calc(input = "input/combined_per_treatment_dafadine.csv")
dafa_s <- hatch_summ1(input = "input/combined_per_treatment_dafadine.csv")
p_dafa <- overview(dafa_c, dafa_s, xf = 0.5)
p_dafa
```

```{r DA, fig.width = 10, fig.height = 7, message = FALSE, warning = FALSE}
#supplemental figure ke_solA

DA_c_solA <- hatch_calc(input = "input/DA_solA.csv")
DA_s_solA <- hatch_summ(input = "input/DA_solA.csv")
sf_DA1 <- range(DA_c_solA, DA_s_solA)
SF5 <- sf_DA1

```


# ALL TOGETHER

```{r allSFs, fig.width = 10, fig.height = 20, message = FALSE, warning = FALSE}
SF1 / SF2 / SF4 / (SF3 + SF5) +  
  plot_annotation(tag_levels = 'A') & 
  theme(plot.tag = element_text(size = 15))
```

